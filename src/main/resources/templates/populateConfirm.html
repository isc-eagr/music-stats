<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Populate song IDs</title>
    <link rel="stylesheet" th:href="@{/css/global.css}" />
    <th:block th:replace="~{fragments/navigation :: nav-styles}"></th:block>
    <style>
        /* Minor adjustments specific to this page */
        .form-card { max-width: 880px; margin: 24px 0; padding: 28px; background: var(--surface); border: 1px solid rgba(255,255,255,0.06); border-radius: var(--radius); box-shadow: var(--shadow); }
        .hint { color: var(--text-muted); margin-bottom:16px; font-size: 14px; }
        .field-row { display:flex; gap:12px; align-items:center; }
        .checkbox-label { color: var(--text-muted); font-size:14px }
        .note { color:var(--text-muted); font-size:13px; margin-top:12px }
        .actions { display:flex; gap:8px; align-items:center; margin-top:12px }
        input { width:100%; padding:8px; margin-bottom:12px; border-radius:6px; border:1px solid rgba(255,255,255,0.06); background:var(--surface-2); color:var(--text) }
        label { display: block; margin-bottom: 6px; font-size: 13px; color: var(--text-muted); }
    </style>
</head>
<body>
    <th:block th:replace="~{fragments/navigation :: navigation}"></th:block>

    <main class="container" style="padding-left: 60px; margin-left: 0; margin-right: auto;">
        <h1 style="margin: 24px 0 16px; font-size: 28px; font-weight: 650;">Populate Song IDs</h1>
        <div class="form-card">
            <p class="hint">This will scan scrobbles and attempt to match each scrobble to an existing song (artist / album / song). The process commits periodically to avoid long transactions.</p>

            <form th:action="@{/scrobbles/populate}" method="post">
                <label for="batchSize">Batch size (rows per DB commit)</label>
                <input type="number" id="batchSize" name="batchSize" th:value="${defaultBatchSize}" min="1" />

                <div class="field-row">
                    <label class="checkbox-label"><input type="checkbox" name="dryRun" value="true" /> Dry run (no DB writes)</label>
                </div>

                <div class="actions">
                    <button class="btn btn-action" type="submit">Run Populate</button>
                    <a class="btn btn-negative" th:href="@{/}">Cancel</a>
                </div>

                <p class="note">Tip: Use dry run first to preview how many records will be matched before committing changes.</p>
            </form>
        </div>
    </main>
</body>
</html>