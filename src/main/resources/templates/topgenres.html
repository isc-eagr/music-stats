<html xmlns:th="http://www.thymeleaf.org">
<head>
	<title>Top Genres</title>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.js'></script>
	<script src='/js/utils.js'></script>
	<script src="/js/table-sort.js"></script>
	<link rel="stylesheet" href="/css/global.css" />
</head>
<body>
	<header class="topbar">
		<div class="container">
			<nav class="breadcrumbs">
				<a href="/">Home</a>
				<span class="sep">/</span>
				<span>Top Genres</span>
			</nav>
			<h1 class="page-title">Top Genres</h1>
		</div>
	</header>

	<main class="container">
		<section class="filters">
			<form th:action="@{/topGenres}" class="filters__form">
				<label class="field">
					<span>Only the top</span>
					<input type="text" th:name="limit" />
				</label>
				<button type="submit" class="btn btn-primary">Apply</button>
			</form>
		</section>

		<section class="data-section">
			<h2 class="section-title">Top genres</h2>
			<div class="table-wrapper">
				<div>Total number of records: <span th:text="${topGenres.size()}"></span></div>
				<table id="genresTable" class="table table-compact js-sortable">
					<thead>
						<tr>
							<th>Position</th>
							<th>Overall Position</th>
							<th>Genre</th>
							<th>Total Plays</th>
							<th>Playtime</th>
							<th>Average Plays Per Song</th>
							<th>Average Song Length</th>
							<th>Number of Artists</th>
							<th>Number of Albums</th>
							<th>Number of Songs</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="topGenre, stat : ${topGenres}">
							<td th:text="${stat.index+1}"></td>
							<td th:text="${stat.index+1}"></td>
							<td><a th:href="@{/category/100/{category}/{value}(value=${topGenre.genre},category=${'Genre'})}" th:text="${topGenre.genre}"></a></td>
							<td th:text="${topGenre.count}" th:attr="data-sort-value=${topGenre.count}"></td>
							<td th:text="${topGenre.playtimeString}" th:attr="data-sort-value=${topGenre.playtime}"></td>
							<td th:text="${#numbers.formatDecimal(topGenre.averagePlays, 1, 'DEFAULT', 2, 'DEFAULT')}" th:attr="data-sort-value=${topGenre.averagePlays}"></td>
							<td th:text="${topGenre.averageLengthString}" th:attr="data-sort-value=${topGenre.averageLength}"></td>
							<td th:text="${topGenre.numberOfArtists}" th:attr="data-sort-value=${topGenre.numberOfArtists}"></td>
							<td th:text="${topGenre.numberOfAlbums}" th:attr="data-sort-value=${topGenre.numberOfAlbums}"></td>
							<td th:text="${topGenre.numberOfSongs}" th:attr="data-sort-value=${topGenre.numberOfSongs}"></td>
						</tr>
					</tbody>
				</table>
			</div>
		</section>
	</main>
</body>

</html>